-# Index
%section.index
  .container
    -# Title
    .row.title-container
      .col-xs-12.col-lg-9
        -# Heading
        %h1#count-title
          -# Render count title
          = render "count_title"
          -# End Heading

      .col-xs-12.col-lg-3.text-right
        -# Show purchase orders button
        .btn-container.inline
          = link_to (admin_purchase_orders_path), class: "btn btn-general" do
            %i.fa.fa-list-alt
            %span= t("purchase.show_orders")
        -# End Show purchase orders button
    -# End Title

    -# Breadcrumb
    .row
      .col-xs-12.hidden-xs
        .breadcrumb-container
          %ol.breadcrumb
            %li
              = link_to (admin_root_path) do
                %i.fas.fa-tachometer-alt
                %span= t("header.navigation.dashboard")
            %li
              = link_to (admin_purchase_orders_path) do
                %i.far.fa-newspaper
                %span= t("purchase.orders")
            %li.active
              %i.fa.fa-list-alt
              = "#{@count == 1 ? t('purchase.order_detail') : t('purchase.order_details')} ##{@purchase.id}"
    -# End Breadcrumb

    .row
      .col-xs-12.col-md-4
        -# Material card
        .material-card.shadow-card
          .row.no-margin
            .col-xs-12.no-padding.details
              .general-info
                .main-info
                  %p= I18n.l(@purchase.purchase_datetime, format: I18n.locale == :es ? "%A, %d #{t('purchase.of')} %B #{t('purchase.of')} %Y" : "%A, %B %d, %Y")
                  %p= I18n.l(@purchase.purchase_datetime, format: "%I:%M:%S %p")

                .main-info.text-left-right
                  %p.text-left
                    %b
                      %i.fas.fa-building
                      %span= t("activerecord.models.provider")
                  %p.text-right= @purchase.provider.name

                  %br

                  %p.text-left
                    %b
                      %i.fas.fa-briefcase
                      %span= t("activerecord.models.employee")
                  %p.text-right= "#{@purchase.employee.first_name} #{@purchase.employee.last_name}"

                %br

                .main-info.text-left-right
                  %p.text-left
                    %b Subtotal
                  %p.text-right= "#{number_to_currency(Purchase.total(@purchase.id), precision: 2, unit: '$', format: '%u%n', separator: '.', delimiter: ',')}"

                  %p.text-left
                    %b= "#{t('activerecord.attributes.purchase.discount')} (#{@purchase.discount}%)"
                  %p.text-right="- #{number_to_currency((Purchase.total(@purchase.id) * (@purchase.discount / 100)), precision: 2, unit: '$', format: '%u%n', separator: '.', delimiter: ',')}"

                  .divider

                  %p.text-left
                    %b Total
                  %p.text-right= number_to_currency((Purchase.total(@purchase.id) - (Purchase.total(@purchase.id) * (@purchase.discount / 100))), precision: 2, unit: "$", format: "%u%n", separator: ".", delimiter: ",")

                %br

                .main-info.hidden
                  %p= t("views.show.created_at", time: time_ago_in_words(@purchase.created_at))
                  %p= t("views.show.updated_at", time: time_ago_in_words(@purchase.updated_at))

                .main-buttons
                  .col-xs-12.col-sm-4.col-md-6.button-container.no-padding
                    = link_to (admin_edit_purchase_path(@purchase)), class: "btn btn-general" do
                      %i.fas.fa-edit
                      %span= t("views.show.edit")

                  .col-xs-12.col-sm-4.col-md-6.button-container.no-padding
                    = link_to (admin_history_purchase_path(@purchase)), class: "btn btn-general" do
                      %i.fas.fa-history
                      %span= t("views.show.history")

                  .col-xs-12.col-sm-4.col-md-12.button-container.no-padding
                    - if(@purchase.state)
                      = link_to (admin_deactive_purchase_path(@purchase)), method: "patch", class: "btn btn-general" do
                        %i.fas.fa-times
                        %span= t("views.show.disable")

                    - else
                      = link_to (admin_active_purchase_path(@purchase)), method: "patch", class: "btn btn-general" do
                        %i.fas.fa-check
                        %span= t("views.show.enable")
        -# End Material card

      .col-xs-12.col-md-8
        -# Material card
        .material-card.shadow-card
          .row.no-margin
            -# Search record
            .col-xs-12.col-md-6.no-padding
              #search-record.search-record
                -# Form
                = form_tag admin_purchase_details_path(@purchase), method: "get", id: "search-form", autocomplete:"off", remote: true do
                  .input-group
                    = text_field_tag :search, params[:search], id: "search-input", class: "form-control", placeholder: t("views.index.search")
                    .border-bottom

                    %span.input-group-btn
                      = button_tag t("elements.search"), id: "search-btn", class: "btn btn-general", data: {disable_with: "<i class='fas fa-spinner fa-spin'></i>"}, "data-toggle": "tooltip", "data-placement": "top", title: t("views.landing.search") do
                        %i.fas.fa-search
                -# End Form
            -# End Search record

            -# Show all
            .col-xs-12.col-md-6.no-padding.text-right
              #show-buttons.btn-container
                -# Render show buttons
                = render "show_buttons"

              -# Export button
              .btn-container
                = link_to (admin_purchase_details_path(@purchase, format: "pdf", lang: I18n.locale)), target: "_blank", class: "btn btn-general btn-default" do
                  %i.fas.fa-download
                  %span= t("views.index.export")
              -# End Export button
            -# End Show all

          -# Render table and pagination with Ajax
          #render-data
            = render "purchase_details"
          -# End Render table and pagination with Ajax
        -# End Material card
-# End Index

-# Pagination with Ajax script
= javascript_include_tag "pagination-ajax", "data-turbolinks-track": "reload"
-# End Pagination with Ajax script

-# Auto search script
= javascript_include_tag "auto-search", "data-turbolinks-track": "reload"
-# End Auto search script
